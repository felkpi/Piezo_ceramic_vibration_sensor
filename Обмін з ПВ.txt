

1. Ресурси блока ПВ, доступні по протоколу Modbus.
Далі блок ПВ називається "блок".

1.1. Ресурси бітового доступу:
1.1.1. Discrete Inputs (read only) (адреси 0 - 65535 = 0 - 0xFFFF) - не доступно
1.1.2. Coils (read / write) (адреси 0 - 65535 = 0 - 0xFFFF) - не доступно

1.2. Ресурси реєстрового (16 біт) доступу:
1.2.1. Input Registers (read only) (адреси 0 - 65535 = 0 - 0xFFFF) - доступно,
ці регістри є 16-бітними, і лише для прочитування інформації з них. Необхідну
інформацію в ці регістри записує лише блок.
1.2.2. Holding Registers (read/write) (адреси 0 - 65535 = 0 - 0xFFFF) -доступно,
ці регістри є 16-бітними, для запису і прочитування інформації. Тут зберігається
багато параметрів, необхідних для роботи блока.


1.3. Ресурси для режиму «НАЛАДКА»

1.3.1. Holding Registers (холдингові регістри, доступне читання і запис).
Адреси холдингових регістрів в блоці.

  Адреса 0 - параметри інтерфейсу RS-485.
  біти 7-0 - адреса блока на шині RS-485 відповідно до протоколу MODBUS:
      Діапазон адреси 1-247 = 0x01 - 0xF7;
  Біти 11-8 - швидкість передачі і прийому (бод):
      0 - 1200, 1 - 2400, 2 - 4800, 3 - 9600, 4 - 19200 , 5 - 38400, 6 - 56000, 7 - 115200;
  Біти 15-12 - додатковий біт: 0 - парний, 1 - непарний, 2 - відсутній). Виробником встановлено:
      Адреса = 10, швидкість = 4 (19200 бод), Додатковий біт = 0 (парний).

  Адреса 1 - тут зберігається початкова адреса холдингових регістрів (Holding Registers),
в яких зберігається конфігураційна інформація блока. Ця адреса може змінюватись, залежно від
версії програми контролера блока.

В адресній зоні, яка визначається блоком ПВ, знаходиться конфігураційна
інформація. Розглянемо структуру конфігураційної інформації,
при цьому адресацію регістрів, в яких вона зберігається, вважаємо відносною,
тобто початковий регістр в масиві конфігураційної інформації має відносну адресу 0:

0 - кількість 16-бітних регістрів, в яких зберігається конфігураційна інформація.
1 - початок конфігураційної інформації. Формат конфігураційної інформації
побайтний, в регістрах інформація зберігається по два байти на регістр,
починаючи зі сташого байта.
Побайтна структура конфігураційної інформації:
байт 0 - в ньому зберігається цифра 3 (початок назви параметра)
байт 1 - відносний номер параметра, нумерація з нуля
байти від 2 до N - текстова назва параметра (побайтно)
байт N+1 - зберігається цифра 0, далі йде текстове значення параметра
байти від N+2 до N+M - текстове значення параметра (побайтно)
Далі весь блок повторюється, якщо є наступний параметр, а якщо
більше конфігураційних параметрів немає, то в наступному байті
знаходиться цифра 10. Це є признаком закінчення конфігураційного масиву.

Приблизний вигляд масиву конфігураційної інформації:

3,0,"Умовне позначення перетворювача",0,
"ПВ-31-2-ХХ",0,
3,1,"Заводський номер (000 - 999)",0,
"001",0,
3,2,"Дата виготовлення",0,
"27.11.2014",0,
3,3,"Дата останнього калібрування",0,
"27.11.2014",0,
3,4,"Верхня границя діапазону",0,
"16 мм/сек",0,
3,5,"Верхня границя робочого діапазону частоти",0,
"1000 Гц",0,
3,6,"Нижня границя робочого діапазону частоти",0,
"10 Гц",0,
3,7,"Верхня границя діапазону НЧ-вібрації",0,
"2 мм/сек",0,
3,8,"Верхня границя робочого діапазону частоти НЧ-вібрації",0,
"25 Гц",0,
3,9,"Нижня границя робочого діапазону частоти НЧ-вібрації",0,
"10 Гц",0,
3,10,"Допустима похибка",0,
"4 %",10


Далі розглядуємо всі інші холдингові регістри, адресація цих регістрів
не відносна, а абсолютна.
Запис в холдинговий регістр за адресою 1 можливий лише після парольного
доступу, при цьому не відбувається запис переданої інформації, але
всі калібровочні та інші параметри блока ПЛП встановлюються
"за замовчуванням". Це є іноді необхідним при значній зміні
параметрів блока.

Доступні холдингові адреси в режимі РОБОТА:

  0 - параметри інтерфейсу RS485. Структура інформації вже описана.
Неможливий прямий запис в регістр з цією адресою, інформація в цьому
регістрі може змінюватись лише відповідно до протокола зміни
параметрів порта RS485 в режимі широкозахватного запиту.

  1 - тут зберігається початкова адреса холдингових регістрів (Holding Registers),
в яких зберігається конфігураційна інформація блока. Ця адреса може змінюватись,
залежно від версії програми контролера блока.

  2,3,4,5 - службова інформація (паролі і ключ). При спробі
прочитати цю інформацію блок замість необхідних значень видає нулі.
При запису в холдинговий регістр за адресою 2 чотирьохзначного числа, яке
є робочим паролем, активується парольний доступ на 5 хвилин. З цього моменту
можливе калібрування блока або інші дії, які виконуються після парольного
доступу.
При спробі передати в холдинговий регістр параметра, який не співпадає
з робочим паролем, парольний доступ блокується, і може бути ввімкнений лише
через 10 секунд при передачі правильного робочого пароля.
Службова інформація за адресами 2,4,5 не може бути змінена чи прочитана 
користувачем.

  6 - розмах шкали вимірювання в сотих долях мм/сек.
Зміна цього параметра доступна в режимі запису одного регістра MODBUS (FC = 6),
але лише після парольного доступу.

  7,8,9,10 - перший і другий коефіцієнт для калібрування блока,
коефіцієнт займає два слова по 16 біт. Інформація за цими адресами формується
лише блоком, і доступна для прочитування, а зміна можлива лише після
парольного доступу.
Запис в ці регістри відбувається згідно калібрувальної таблиці.
Блок ПВ ігнорує інформацію, яка передається для запису по калібровочній
адресі, але виконує калібрування у вказаній точці діапазону вимірювання.

     Калібрувальна таблиця:
Адреса 7 - калібрування в точці, коли віброшвидкість = 100% від номінальної,
тобто величина віброшвидкості дорівнює встановленому розмаху шкали вимірювання
віброшвидкості.
Адреса 9 - калібрування в точці, коли віброшвидкість = 10% від номінальної.

Калібрування можливе після парольного доступу. Період часу між
кожною калібрувальною точкою не може бути більше 5 хвилин,
інакше знімається парольний доступ.
Алгоритм калібрування: встановлюються параметри згідно потрібного
рядка таблиці, потім відбувається запис будь-якої інформації
в відповідний холдинговий регістр згідно калібрувальної таблиці.
Блок ПВ запам'ятовує поправочні коефіцієнти калібрування у внутрішній
енергонезалежній пам'яті для конкретної точки калібрування.

  11 - уставка 1 в сотих долях мм/сек.
Зміна цього параметра доступна в режимі запису одного регістра MODBUS (FC = 6).

  12 - уставка 2 в сотих долях мм/сек.
Зміна цього параметра доступна в режимі запису одного регістра MODBUS (FC = 6).

  13 - уставка "Аварія" в сотих долях мм/сек.
Зміна цього параметра доступна в режимі запису одного регістра MODBUS (FC = 6).

  14 - уставка "Аварія НЧ" в сотих долях мм/сек.
Зміна цього параметра доступна в режимі запису одного регістра MODBUS (FC = 6).

  15 - затримка попереджень в десятих долях секунди (затримці 3 сек
відповідає число 30).
Зміна цього параметра доступна в режимі запису одного регістра MODBUS (FC = 6).

  16 - затримка індикації несправності в десятих долях секунди (затримці 5 сек
відповідає число 50).
Зміна цього параметра доступна в режимі запису одного регістра MODBUS (FC = 6).

  17 - стала часу СКЗ. Це число від 0 до 4, цьому числу відповідає:
0 - стала часу 0.1 сек,
1 - стала часу 0.3 сек,
2 - стала часу 1 сек,
3 - стала часу 3 сек,
4 - стала часу 10 сек.
Зміна цього параметра доступна в режимі запису одного регістра MODBUS (FC = 6).

  18 - масштабуючий множник для прочитування графічного спектра і кругової діаграми
(стартова величина множника = 1). Збільшення множника може бути потрібне
користувачеві при аналізі сигналу в нижній частині шкали.
Користувач має право збільшувати цей коефіціент (коефіціент є цілим числом)
для більш детального аналізу малих переміщень чи вібрацій.

  19 - параметр для ЦАП D32, аналоговий вихід з цього ЦАПа потрібен при
наладці блока, в роботі блока він не грає ніякої ролі. ЦАП D32 є восьмибітним,
параметр для ЦПА може бути в межах від 0 до 255.

  20,21,22,23 - установочна часова інформація (година і хвилина, дата і місяць,
рік). Необхідно для запису часу останнього калібрування блока.
Адреса 20: секунди
Адреса 21: старший байт - години, молодший - хвилини
Адреса 22: Старший байт - дата, молодший байт - місяць (від 1 до 12)
Адреса 23: поточний рік
Запис в ці холдингові регістри можливий або в режимі "запис в один
холдинговий регістр", або в режимі "запис в багато холдингових регістрів".
Інформація за цими адресами може бути змінена лише після парольного
доступу. Після зміни будь-якого з цих параметрів потрібен запис
в холдинговий регістр за адресою 24, для ініціалізації (перевстановлення)
внутрішнього годинника ПВ.

  24 - при звертанні за цією адресою йде ініціалізація попередньо
встановленого внутрішнього годинника ПЛП. Ініціалізація годинника
можлива лише після парольного доступу.

  25 - адреса для скидання скачка і керування режимами скачка.
При запису параметра за цією адресою відбувається скидання скачка,
якщо "1" в старшому біті параметра (біт 15), або дозвіл - заборона скачка,
якщо в біті 14 "1/0". "1" - дозволено, 0 - заборонено.
При дозволі скачка розрахунок скачка починається спочатку. 
Зміна цього параметра доступна в режимі запису одного регістра MODBUS (FC = 6).

  26 - адреса для скидання тренда і керування режимами тренда. При запису
параметра за цією адресою відбувається скидання тренда, якщо "1" в старшому
біті параметра (біт 15), або дозвіл - заборона тренда, якщо в біті 14 "1/0".
При встановленні дозволу тренда запускається вираховування тренда,
Якщо в біті 13 - "1", то це ввімкнення контрольного режиму тренда, замість
годин він починає користуватись секундами, при цьому обчислення тренда однократно
запускається. Після закінчення періоду тренда він сам переводиться в звичайний режим.
Зміна цього параметра доступна в режимі запису одного регістра MODBUS (FC = 6).

  27 - сюди записується час для тренда в годинах.

  28 - за цією адресою йде управління обчисленням спектра. Залежно від
значення параметра, який записується за цією адресою, виконується наступна дія:
	1 - рахувати спектр віброприскорення (і рахувати гармоніки)
	2 - рахувати спектр віброшвидкості (і рахувати гармоніки)
	3 - рахувати спектр вібропереміщення (і рахувати гармоніки)
	0 - не рахувати спектри.

  29 - адреса для керування прочитуванням журнала подій.
Журнал подій поповнюється новими записами при зміні вимірюваного
параметра (віброшвидкості) більше, ніж на 3% від номінального розмаху
віброшвидкості (напиклад, 16 мм/сек), а також при зміні будь-якого
біта в слові статусу чи зміні таких параметрів як уставки, затримки попереджень
і аварій, і при ввімкненні блока ПВ.
Будь-який запис в журналі подій неможливо витерти чи змінити дистанційно,
через порти RS485. Будь-який запис в журналі подій є відкритим для прочитування.
Кількість записів в журналі не може перевищувати 32768, при перевищенні
цієї кількості найбільш давні записи журнала затираються. В журналі також
фіксується час і дата, коли зроблений кожен запис.
Запис журнала складається з 18 слів (36 байт). Для прочитування
бажаного запису при запису в холдинговий регістр 29 в ролі параметра
передається номер бажаного запису. Прочитується запис з вхідних регістрів
з номерами від 2000 до 2017.

  30 - тут вказана довжина конфігураційного масиву в словах.

  31-500 адресна зона для зберігання конфігураційної інформації. Зміна цієї
інформації можлива лише після парольного доступу.



1.6. Ресурси режиму «РОБОТА»

1.6.1. Holding Registers (доступне читання і запис)

Прочитування Holding Registers є обов'язковим на початку роботи комп'ютера, яких
обробляє результати вимірювань з ПВ, а також необхідно прочитувати Holding Registers 
після отримання і зникнення сигналу "НЕСПРАВНІСТЬ", тому що за час дії сигналу
"НЕСПРАВНІСТЬ" оператор міг замінити блок ПВ на подібний.

Весь обмін інформації з холдинговими регістрами в режимі "Робота" повністю
співпадає з обміном в режимі "Наладка".



1.6.2. Input Registers (лише читання). Адреси регістрів з даними.
Це не холдингові регістри, а вхідні регістри, і в них своя адресація,
яка не залежить від адресації холдингових регістрів, і може перекриватись
з адресацією холдингових регістрів.
Прочитування всіх Input Registers не є обов'язковим, програма центрального
комп'ютера може прочитувати лише ті параметри, які потрібні оператору.

  0 - загальна вібрація в сотих долях мм/сек

  1 - зміщення вібрації відносно тренда в сотих долях мм/сек

  2 - НЧ вібрація в сотих долях мм/сек

  3 - вібраційне переміщення в мікронах

  4 - зарезервовано

  5 - побітний статус отриманих даних
	біт 0 = 1 - якщо виявлена несправність
	біт 1 = 1 - якщо спрацювала уставка 1
	біт 2 = 1 - якщо спрацювала уставка 2
	біт 3 = 1 - якщо спрацювала уставка Аварія
	біт 4 = 1 - якщо спрацювала уставка Аварія НЧ
	біт 5 = 1 - признак ввімкненого режиму КОНТРОЛЬ
	біт 6 = 1 - признак, що спрацював СКАЧОК
	біт 7 = 1 - признак дозволеності СКАЧОК
	біт 8 = 1 - признак, що спрацював ТРЕНД
	біт 9 = 1 - признак дозволеності ТРЕНД
	біт 10 = 1 - признак, що дозволений тестовий режим ТРЕНД

  6 - це параметр, в молодшому байті якого знаходиться відносний лічильник виборок
для спектра (заодно індикатор готовності, а якщо 0, то ще нічого нема).
З кожним новим вирахуваним спектром значення цього байта збільшується на 1.
Якщо ми змінюємо спектр (наприклад, рахували спектр віброприскорення,
а тепер хочемо рахувати спектр віброшвидкості), то значення цього байта
скидується в 0. Таке перевстановлення спектра здійснюється записом
в холдинговий регістр 28 необхідного параметра (1,2 чи 3).
Якщо цей параметр (1,2 чи 3) співпадає з тим, який був попередньо записаний,
відносний лічильник виборок так само скидується в 0.
В старшому байті цього параметра - індикатор, який спектр (віброприскорення,
віброшвидкість чи вібропереміщення) ми можемо прочитувати.
Значення цього байта:
	1 - обчислювати спектр віброприскорення
	2 - обчислювати спектр віброшвидкості
	3 - обчислювати спектр вібропереміщення
	0 - не обчислювати спектр. При цьому також не обчислюються амплітуди гармонік
	
   7 - амплітуда половинної гармоніки віброшвидкості, позначається 0.5 (16 біт),
беззнакове ціле число. Всі амплітуди гармонік віброшвидкості представлені в 
сотих долях мм/сек.

   8 - фаза гармоніки віброшвидкості 0.5 (15 біт і знак), ціле знакове число
в десятих долях градуса

   9 - амплітуда гармоніки віброшвидкості 1 (16 біт), беззнакове ціле число

  10 - фаза гармоніки 1 віброшвидкості (15 біт і знак), ціле знакове число
в десятих долях градуса

  11 - амплітуда гармоніки віброшвидкості 2 (16 біт), беззнакове ціле число

  12 - фаза гармоніки віброшвидкості 2 (15 біт і знак), ціле знакове число
в десятих долях градуса

  13 - амплітуда половинної гармоніки вібропереміщення, позначається 0.5 (16 біт),
беззнакове ціле число. Всі амплітуди гармонік вібропереміщення представлені в 
мікронах.

  14 - фаза гармоніки вібропереміщення 0.5 (15 біт і знак), ціле знакове число
в десятих долях градуса

  15 - амплітуда гармоніки вібропереміщення 1 (16 біт), беззнакове ціле число

  16 - фаза гармоніки 1 вібропереміщення (15 біт і знак), ціле знакове число
в десятих долях градуса

  17 - амплітуда гармоніки вібропереміщення 2 (16 біт), беззнакове ціле число

  18 - фаза гармоніки вібропереміщення 2 (15 біт і знак), ціле знакове число
в десятих долях градуса

  19 - значення струму 1 в тисячних долях міліампера
  20 - значення струму 2 в тисячних долях міліампера

  21,22,34,24 - часова інформація згідно внутрішнього годинника блока.
	21: секунди
	22: старший байт - години, молодший - хвилини
	23: Старший байт - дата, молодший байт - місяць (від 1 до 12)
	24: поточний рік


  1000 - 1500 - тут знаходиться обчислений спектр. Для обчислення спектра
ми можемо вказати: обчислювати віброприскорення, віброшвидкість, або вібропереміщення.
Передбачено обчислення спектра в частотному діапазоні від 0 до 1000 Гц,
при цьому ми не пропускаємо сигнал через цифрову фільтрацію, обчислюється
спектр нефільтрованого сигналу.
Спектр складається з 500 точок, частота в кожній точці обчислюється як
номер точки (нумерація від 0), перемножений на 2.
Кожна точка спектра представлена в масиві цілим 16-бітним числом, це амплітуда
спектра в даній точці.
Амплітуда промасштабована так, що моногармонічному синусоїдальному
вхідному сигналу з амплітудою віброшвидкості 16 мм/сек відповідає
максимальна амплітуда спектра, представлена цілим числом 16000.
Кожна точка спектра представлена лише амплітудою.
Перед прочитуванням спектра ми можемо змінити масштабуючий коефіцієнт,
за замовчуванням він = 1. Ми можемо встановити цей коефіцієнт рівним
будь-якому цілому числу, більшому від 0. Наприклад, 2, 5, 10, значення немає.
Збільшення мастабуючого коефіцієнта є корисним, якщо ми хочемо проаналізувати
графічні дані (спектр чи кругову діаграму) в умовах значно меншої вібрації.


  2000 - початкова адреса для прочитування потрібного запису з журнала
подій. Необхідний номер запису замовляється попереднім звертанням
до холдингового регістра 29.
Адреси від 2000 до 2017 містять 18 слів одного запису журнала подій.
Адреса 2000 - номер останнього запису, зробленого блоком ПЛП в журналі подій.
Адреса 2001 - номер прочитаного запису.
Адреса 2002 - подія запису:
  1 - ввімкнення блока.
  2 - зміна результату більше, ніж на 3%.
  3 - зміна слова статусу
  4 - зміна інформації в холдингових регістрах з номерами від 6 до 16.
Адреса 2003 - 2017 - інформація за цими адресами залежить від типу запису
в журналі подій.

При ввімкненні блока, зміні результату чи слова статусу:
Адреса 2003 - виміряний результат (загальна вібрація)
Адреса 2004 - зміщення вібрації відносно тренда
Адреса 2005 - НЧ вібрація
Адреса 2006 - вібраційне переміщення
Адреса 2007 - зазор у сотих долях мм
Адреса 2008 - побітний статус отриманих даних
	Біти статусу:
	------------
	біт 0 = 1 - якщо виявлена несправність
	біт 1 = 1 - якщо спрацювала уставка 1
	біт 2 = 1 - якщо спрацювала уставка 2
	біт 3 = 1 - якщо спрацювала уставка Аварія
	біт 4 = 1 - якщо спрацювала уставка Аварія НЧ
	біт 5 = 1 - признак ввімкненого режиму КОНТРОЛЬ
	біт 6 = 1 - признак, що спрацював СКАЧОК
	біт 7 = 1 - признак дозволеності СКАЧОК
	біт 8 = 1 - признак, що спрацював ТРЕНД
	біт 9 = 1 - признак дозволеності ТРЕНД
	біт 10 = 1 - признак, що дозволений тестовий режим ТРЕНД

При зміні інформації в холдингових регістрах з адресами від 6 до 16:
Адреса 2003 - розмах шкали вимірювання
Адреса 2004 і 2005 - уточнюючий перший коефіцієнт для масштабування
віброшвидкості (він займає два слова)
Адреса 2006 і 2007 - уточнюючий другий коефіцієнт для масштабування
віброшвидкості (він займає два слова)
Адреса 2008 - уставка 1 в сотих долях мм/сек
Адреса 2009 - уставка 2 в сотих долях мм/сек
Адреса 2010 - уставка Аварія в сотих долях мм/сек
Адреса 2011 - уставка Аварія НЧ  в сотих долях мм/сек
Адреса 2012 - затримка попереджень
Адреса 2013 - затримка індикації несправності

Для всіх видів записів в журналі:
Адреса 2014 - години (старший байт) і хвилини (молодший байт).
Адреса 2015 - дата (старший байт) і місяць (молодший байт, від 1 до 12).
Адреса 2016 - рік (можливі записи від 2000 до 2255).
Адреса 2017 - контрольна сума запису в журналі подій.
Синхронізація внутрішнього годинника блока ПЛП є доступною за допомогою
запису в відповідні холдингові регістри.



  2200 - 2260 - тут знаходяться значення вібропереміщень за один оберт вала,
через кожні 6 градусів. Значення вібропереміщення за адресою 2260 - це
практично початок нового оберта. На базі масиву цих вібропереміщень можна
будувати, наприклад, кругову діаграму мікропереміщення вала чи підшипника.
Якщо в датчику відсутній синхросигнал, вимірювання кругової діаграми
неможливе, і тоді в масиві вібропереміщень знаходяться нулі.
Перед прочитуванням кругової діаграми ми також можемо змінити масштабуючий
коефіцієнт, за замовчуванням він = 1. Ми можемо встановити цей коефіцієнт рівним
будь-якому цілому числу, більшому від 0. Наприклад, 2, 5, 10, значення немає.
Збільшення мастабуючого коефіцієнта є корисним, якщо ми хочемо проаналізувати
графічні дані (спектр чи кругову діаграму) в умовах значно меншої вібрації.

З момента, як прочитане значення першої точки спектра (адреса 1000)
чи першої точки кругової діаграми (адреса 2200), блок не змінює прораховану
виборку до того, як буде прочитане останнє значення спектра (адреса 1500)
чи останнє значення кругової діаграми (адреса 2060). Це є страховкою,
щоб з блока не прочитали частину одної виборки, а далі частину вже іншої
виборки.
Але якщо перез помилку в програмі вищого рівня, яка проводить опитування
блока, відсутнє прочитування останньої точки для графіка спектра чи
кругової діаграми, то через 15 секунд блок скидує блокування зміни
виборки, і прочинає прораховувати наступну виборку.

Одним запитом можна прочитати, згідно протокола MODBUS, не більше 124 регістри,
тобто не більше ніж 62 точки спектра.

Коректний алгоритм прочитування спектра такий:

1. Встановити прочитування спектра віброшвидкості, чи спектра віброприскорення,
чи вібропереміщення відповідним звертанням до холдингового регістра, який керує
обчисленням спектра, це регістр 28.

2. Встановити, при необхідності, масштабуючий коефіцієнт, з допомогою запису
цього коефіцієнта в холдинговий регістр 18.

3. Почати прочитування необхідних точок спектра.

Аналогічним способом йде прочитування кругової діаграми вібропереміщень.
Встановлюється, при необхідності, масштабуючий коефіцієнт, а далі можна
прочитувати масив для кругової діаграми.



2. Програмування обміну по MODBUS

2.1. Програмування параметрів інтерфейсу RS485 (режим «НАЛАДКА»)
Для програмування параметрів RS485 використовується широкозахватний запит за адресою 0.

Структура широкозахватного запиту (Broadcast):
- байт 0 - адреса пристрою на шині RS485 (значення 0x00). Умовна назва "MbAddr".
- байт 1 - код функції «Write Single Register» (0x06).  Умовна назва "FC".
- байти 2,3 - адреса регістру для запису (2 байти: 0x0000). Умовна назва "StAddr".
- байти 4,5 - інформація для запису (2 байти, починаючи зі сташого). Умовна назва "Regs".
  біти 7-0 - нова адреса ПВ на шині RS-485 відповідно до протоколу MODBUS:
      Діапазон адреси 1-247 = 0x01 - 0xF7;
  Біти 11-8 - нова швидкість передачі і прийому (бод):
      0 - 1200, 1 - 2400, 2 - 4800, 3 - 9600, 4 - 19200 , 5 - 38400, 6 - 56000, 7 - 115200;
  Біти 15-12 - новий додатковий біт: 0 - парний, 1 - непарний, 2 - відсутній).
- байти 6,7 - контрольна сума, починаючи з молодшого байта. Умовна назва "CRC16".


2.3. Читання результатів вимірювання в режимі «РОБОТА».
Використовується функція 4 Modbus (FC = 4) «Read Input Registers»

Структура запиту
- MbAddr - адреса пристрою на шині RS485 (один байт: 1-247 = 0x01 - 0xF7)
- FC - код функції «Read Input Registers» (один байт: 0x04)
- StAddr - стартова адреса даних (2 байти, починаючи зі старшого)
- NRegs - кількість регістрів (2 байти, починаючи зі старшого).
	Кількість регістрів не може бути більшою від 125.
- CRC16 (контрольна сума, починаючи з молодшого байта)

Структура правильної відповіді
- MbAddr - адреса пристрою на шині RS485 (один байт: 1-247 = 0x01 - 0xF7)
- FC - код функції «Read Input Registers» (1 байт: 0x04)
- NBytes - тут подвоєна кількість запитаних регістрів
- Regs - регістри з результатами. Кожний регістр представлений
двома байтами, спочатку старший байт, потім молодший. 
- CRC16 (2 байти, починаючи з молодшого)

Блок дозволяє прочитування будь-яких вхідних регістрів (Input Registers)
в адресній зоні від 0 до 10.

2.4. Читання будь-яких HOLDING REGISTERs.
Використовується функція 3 MODBUS (FC = 3) «Read Holding Registers»

Структура запиту
- MbAddr - адреса пристрою на шині RS485 (1 байт: 1-247 = 0x01 - 0xF7)
- FC - код функції «Read Holding Registers» (1 байт: 0x03)
- StAddr - стартова адреса даних (2 байти, починаючи зі старшого)
- NRegs - кількість регістрів з даними (2 байти, починаючи зі старшого).
	Кількість регістрів не може бути більшою від 125.
- CRC16  (2 байти, починаючи з молодшого)

Структура правильної відповіді
- MbAddr - адреса пристрою на шині RS485 (один байт: 1-247 = 0x01 - 0xF7)
- FC - код функції «Read Input Registers» (1 байт: 0x04)
- NBytes - тут подвоєна кількість запитаних регістрів
- Regs - регістри з даними (по 2 байти на регістр, починаючи зі старшого)
- CRC16 (2 байти, починаючи з молодшого)

Блок дозволяє прочитування будь-яких холдингових регістрів (Holding Registers)
в адресній зоні від 0 до 500.

2.5. Запис багатьох HOLDING REGISTERs
Використовується функція 16 (0x10) MODBUS (FC = 16) «Write Multiple Registers»

Структура запиту
- MbAddr - адреса пристрою на шині RS485 (1 байт: 1-247 = 0x01 - 0xF7)
- FC - код функції «Write Multiple Registers» (1 байт: 0x10)
- StAddr - стартова адреса даних (2 байти, починаючи зі старшого)
- NRegs - кількість регістрів (2 байти, починаючи зі старшого)
- Regs - регістри з даними (по 2 байти на регістр, починаючи зі старшого)
- CRC16 (2 байти, починаючи з молодшого)

Структура правильної відповіді
- MbAddr - адреса пристрою на шині RS485 (1 байт: 1-247 = 0x01 - 0xF7)
- FC - код функції «Write Multiple Register» (1 байт: 0x10)
- StAddr - стартова адреса регістрів (2 байти, починаючи зі старшого)
- NRegs - кількість регістрів (2 байти, починаючи зі старшого)
- CRC16 (2 байти, починаючи з молодшого)

Режим «Write Multiple Register» дозволений для необхідних змін
в масиві конфігураційної інформації, але блок виконує такі зміни
лише після підтвердження парольного запиту. Зміна конфігураційної
інформації недоступна в режимі звичайної експлуатації блока,
і виконується лише після виготовлення або модернізації блока.

2.6. Запис одного HOLDING REGISTER
Використовується функція 6 (0x6) Modbus (FC = 6) «Write Single Registers»

Структура запиту
- MbAddr - адреса пристрою на шині RS485 (1 байт: 1-247 = 0x01 - 0xF7)
- FC - код функції «Write Multiple Registers» (1 байт: 0x6)
- StAddr - адреса регістра (2 байти, починаючи зі старшого)
- NRegs - інформація для запису в регістр (2 байти, починаючи зі старшого)
- CRC16 (2 байти, починаючи з молодшого)

Структура правильної відповіді: блок відповіді повинен
повторювати блок запиту.

Блок дозволяє запис в доступні холдингові адреси, а також
дозволяє запис калібровочної інформації після парольного доступу.
Зміна калібровочної інформації необхідна для періодичного
калібрування блока. Парольний доступ страхує калібровочну таблицю
від пошкодження при неправильній роботі обслуговуючої програми
комп'ютера, який проводить опитування блока через інтерфейс RS485.



Номери, щоб я не забув:

      - ПЛП (перетворювач лінійних переміщень) - від 10 до 19
      - ПВ (перетворювач віброшвидкості ПВ) - від 20 до 39
      - ПВВ ( перетворювач вібрації валу вихорострумовий) - від 40 до 59
      - ПОВ (перетворювач осьового зсуву валу вихорострумовий) - від 60 до 69
      - ПЗВ ( перетворювач миттєвих значень зазору вихорострумовий) - від 70 до 79
      - частотомір - від 80 до 89








